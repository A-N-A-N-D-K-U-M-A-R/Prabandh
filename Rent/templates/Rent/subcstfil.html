{% extends 'Rent/Weddings.html' %}
{% load static %}
{% block css %}

{% endblock css %}
{% block content %}
    <main>
        {% for i in product %}
            <div class="card mb-3 border-bottom" style="max-width: 540px;">
              <div class="row g-0 border-bottom">
                <div class="col-md-3 col-sm-4">
                  <img src='/media/{{i.image_of_product}}' class="img-fluid me-2" alt="...">
                </div>
                <div class="col-md-9 col-sm-8">
                    <div class="card-body">
                      <h5 class="card-title">{{i.title}}</h5>
                          <div id="ca">
                              {{i.score}}
                          </div>
                            <span class="fa fa-star checked" id="first"></span>
                            <span class="fa fa-star checked" id="second"></span>
                            <span class="fa fa-star checked" id="third"></span>
                            <span class="fa fa-star" id="fourth"></span>
                            <span class="fa fa-star" id="fifth"></span>
                            
                            <p class="card-text">
                              {{i.about}}<BR>Rent Price: {{i.rental_price}}</BR>
                              Deposit:{{i.deposit}}
                            </p>
                    </div>
                  <a href="/cartdel/{{i.id}}" class="btn btn-danger" style="margin-right:10px;">Remove</a>
                  <a href="#" class="btn btn-primary">Rent</a>
                </div>
              </div>
            </div>
     {% endfor %}
            <center>
                <b>Total Amount:{{sum}}<b><br/>
                  <!-- <form action="{% url 'checkout' %}" method="POST"> -->
                    <!-- {% csrf_token %} -->
                    <button class="btn-primary" id="checkout-button">Proceed to checkout</button>
                  <!-- </form> -->
            </center>
            {% csrf_token %}
    </main>
{% endblock %}
{% block js %}
<script type="text/javascript">
  const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;

  // Create an instance of the Stripe object with your publishable API key
  var stripe = Stripe("{{ STRIPE_PUBLIC_KEY }}");
  var checkoutButton = document.getElementById("checkout-button");

  checkoutButton.addEventListener("click", function () {
    fetch("{% url 'checkout' %}", {
      method: "POST",
      headers: {
          'X-CSRFToken': csrftoken,
      },
    })
      .then(function (response) {
        return response.json();
      })
      .then(function (session) {
        return stripe.redirectToCheckout({ sessionId: session.id });
      })
      .then(function (result) {
        // If redirectToCheckout fails due to a browser or network
        // error, you should display the localized error message to your
        // customer using error.message.
        if (result.error) {
          alert(result.error.message);
        }
      })
      .catch(function (error) {
        console.error("Error:", error);
      });
  });
</script>


{% endblock js %}




<!-- <!DOCTYPE html>
<html>
  <head>
    <title>Buy cool new product</title>
    <link rel="stylesheet" href="style.css">
    
  </head>
  <body>
    <section>
      <div class="product">
        <img src="https://i.imgur.com/EHyR2nP.png" alt="The cover of Stubborn Attachments" />
        <div class="description">
          <h3>Stubborn Attachments</h3>
          <h5>$20.00</h5>
        </div>
      </div>
      
    </section>
  </body>
</html> -->